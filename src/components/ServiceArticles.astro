---
import { getCollection } from 'astro:content';

interface Props {
  slugs: string[];
  title?: string;
  subtitle?: string;
  bg?: 'white' | 'emerald';
}

const { slugs, title = "Learn More", subtitle, bg = 'white' } = Astro.props;

const allArticles = await getCollection('articles', ({ data }) => data.draft !== true);

const articles = slugs
  .map(slug => allArticles.find(a => a.slug === slug))
  .filter(Boolean);

const sectionClass = bg === 'emerald' ? 'py-16 lg:py-24 bg-emerald-50' : 'py-16 lg:py-24 bg-white';
const cardClass = bg === 'emerald'
  ? 'bg-white rounded-xl p-6 hover:shadow-lg transition-shadow group'
  : 'bg-emerald-50 rounded-xl p-6 hover:bg-emerald-100 transition-colors group';
---

{articles.length > 0 && (
  <section class={sectionClass}>
    <div class="section-shell">
      <div class="text-center mb-10">
        <h2 class="text-3xl sm:text-4xl font-serif font-bold text-emerald-950 mb-4">{title}</h2>
        {subtitle && <p class="text-lg text-gray-600">{subtitle}</p>}
      </div>
      <div class="grid md:grid-cols-3 gap-6 max-w-5xl mx-auto">
        {articles.map(article => (
          <a href={`/articles/${article!.slug}`} class={cardClass}>
            <h3 class="font-serif font-bold text-emerald-950 mb-2 group-hover:text-emerald-700">{article!.data.title}</h3>
            <p class="text-gray-600 text-sm">{article!.data.description}</p>
          </a>
        ))}
      </div>
    </div>
  </section>
)}
